# Stock Report Generation System - Apache Configuration
# PHP 5.5 Compatible
#
# SUBDIRECTORY INSTALLATION:
# If installing in a subdirectory (e.g., /myapp or /tools/project/aistocks),
# you must:
# 1. Change RewriteBase below to match your subdirectory path
#    Example: RewriteBase /tools/testproject/contractord/aistocks
# 2. Update BASE_URL in app/config/config.php to match
#    Example: define("BASE_URL", "/tools/testproject/contractord/aistocks");

# Protect sensitive files
<FilesMatch "^(reportSettings\.json|\.env)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# File upload settings
php_value upload_max_filesize 10M
php_value post_max_size 10M

# URL Rewriting - Route all requests through public/
<IfModule mod_rewrite.c>
    RewriteEngine On
    # For subdirectory test, use: /tools/testproject/contractord/aistocks
    # For production at root, use: /
    RewriteBase /

    # Prevent direct access to app directory
    RewriteRule ^app/ - [F,L]

    # Allow direct access to asset directories
    RewriteRule ^(reports|images|data)/ - [L]

    # Serve static assets from public/assets/
    RewriteRule ^assets/(.*)$ public/assets/$1 [L]

    # Rewrite reportManager.html to public/index.php
    RewriteRule ^reportManager$ public/index.php [L,QSA]

    # Rewrite reportManager.html to public/index.php
    RewriteRule ^phpinfo$ public/phpinfo.php [L,QSA]

    # Rewrite root and index.php to public/index.php
    RewriteRule ^index\.php$ public/index.php [L,QSA]
    RewriteRule ^$ public/index.php [L,QSA]
</IfModule>
